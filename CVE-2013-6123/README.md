# CVE-2013-6123

hello 含有漏洞的驱动模块
run_cve 漏洞利用代码

## 获得root的步骤如下：
1.调用get_symbols_from_kernel，获取设备的地址。
2.通过驱动的任意写漏洞，通过patch_sys_settimeofday函数,将settimeofday的系统调用改成commit_creds(prepare_kernel_cred(0)的实现。
3.调用trigger_syscall_hook函数，使得获取ROOT权限的commit_creds(prepare_kernel_cred(0)代码得以运行。
4.fix_syscall_hook()将settimeofday的系统调用改成空实现，防止其他进程调用settimeofday而使系统崩溃。



分析文章：
https://blog.csdn.net/tangsilian/article/details/86361480

主要参考：https://bbs.pediy.com/thread-210424-1.htm


